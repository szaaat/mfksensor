<!-- 1. Nyelvválasztó a fejlécben -->
<header class="bg-green-700 text-white text-center py-8 shadow-lg relative">
  <div class="absolute top-4 right-4 flex space-x-2">
    <button id="lang-hu" class="lang-btn active" data-lang="hu">HU</button>
    <button id="lang-en" class="lang-btn" data-lang="en">EN</button>
  </div>
  <h1 id="main-title" class="text-2xl md:text-4xl font-extrabold tracking-tight">Éghajlatváltozás Multidiszciplináris Nemzeti Laboratórium 7B alprojekt levegőminőség szenzor adatok</h1>
</header>

<!-- 2. Navigációs menü frissítése -->
<nav class="bg-green-600 text-white py-4 shadow-md">
  <div class="container mx-auto px-6 flex justify-center space-x-8">
    <a href="/mfksensor/" id="nav-home" class="text-lg font-semibold hover:text-green-200 transition-colors">Kezdőlap</a>
    <a href="/mfksensor/map.html" id="nav-map" class="text-lg font-semibold hover:text-green-200 transition-colors">Térkép</a>
  </div>
</nav>

<!-- 3. Szenzor választó címke frissítése -->
<div class="mb-8 max-w-md mx-auto">
  <label for="sensorSelect" id="sensor-label" class="block text-lg font-semibold text-gray-700 mb-2">Válassz szenzort:</label>
  <select id="sensorSelect" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500">
    <option value="sensor1">Egri Szenzor</option>
  </select>
</div>

<!-- 4. Lábléc frissítése -->
<footer class="bg-green-700 text-white text-center py-4 mt-auto">
  <p id="footer-text" class="text-sm">© Éghajlatváltozás Multidiszciplináris Nemzeti Laboratórium projekt támogatásával valósul meg.</p>
</footer>

<!-- 5. Script rész bővítése -->
<script>
  // Nyelvi beállítások
  const translations = {
    hu: {
      title: "Éghajlatváltozás Multidiszciplináris Nemzeti Laboratórium 7B alprojekt levegőminőség szenzor adatok",
      navHome: "Kezdőlap",
      navMap: "Térkép",
      sensorLabel: "Válassz szenzort:",
      timestamp: "Időbélyeg",
      pm1: "PM1",
      pm25: "PM2.5",
      pm4: "PM4",
      pm10: "PM10",
      humidity: "Páratartalom",
      temp: "Hőmérséklet",
      voc: "VOC",
      nox: "NOx",
      co2: "CO2",
      lastUpdated: "Utolsó frissítés:",
      disclaimer: "A mérési adatok nem hitelesítettek.",
      footer: "© Éghajlatváltozás Multidiszciplináris Nemzeti Laboratórium projekt támogatásával valósul meg."
    },
    en: {
      title: "Climate Change Multidisciplinary National Laboratory 7B Subproject Air Quality Sensor Data",
      navHome: "Home",
      navMap: "Map",
      sensorLabel: "Select sensor:",
      timestamp: "Timestamp",
      pm1: "PM1",
      pm25: "PM2.5",
      pm4: "PM4",
      pm10: "PM10",
      humidity: "Humidity",
      temp: "Temperature",
      voc: "VOC",
      nox: "NOx",
      co2: "CO2",
      lastUpdated: "Last updated:",
      disclaimer: "Measurement data is not verified.",
      footer: "© Realized with the support of the Climate Change Multidisciplinary National Laboratory project."
    }
  };

  // Nyelv beállítása és frissítés
  function setLanguage(lang) {
    localStorage.setItem('language', lang);
    applyLanguage(lang);
  }

  function applyLanguage(lang) {
    const langData = translations[lang];
    
    // Frissítjük az oldal elemeit
    document.getElementById('main-title').textContent = langData.title;
    document.getElementById('nav-home').textContent = langData.navHome;
    document.getElementById('nav-map').textContent = langData.navMap;
    document.getElementById('sensor-label').textContent = langData.sensorLabel;
    document.getElementById('footer-text').textContent = langData.footer;
    document.querySelector('#lastUpdated').previousElementSibling.textContent = langData.disclaimer;
    
    // Gombok aktív állapotának beállítása
    document.querySelectorAll('.lang-btn').forEach(btn => {
      btn.classList.toggle('active', btn.dataset.lang === lang);
    });
  }

  // Oldal betöltésekor
  document.addEventListener('DOMContentLoaded', () => {
    // Alapértelmezett nyelv beállítása
    const savedLang = localStorage.getItem('language') || 'hu';
    setLanguage(savedLang);

    // Nyelvválasztó gombok eseménykezelői
    document.querySelectorAll('.lang-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        setLanguage(btn.dataset.lang);
      });
    });

    // A mezőcímkék frissítése a CSV adatok betöltésekor
    const originalFetchAndDisplayData = fetchAndDisplayData;
    fetchAndDisplayData = async function() {
      await originalFetchAndDisplayData();
      updateDataLabels();
    };

    function updateDataLabels() {
      const lang = localStorage.getItem('language') || 'hu';
      const langData = translations[lang];
      
      document.querySelectorAll('#dataTable > div').forEach(cell => {
        const header = cell.querySelector('h3');
        if (header) {
          const key = header.textContent.trim();
          for (const [enKey, huText] of Object.entries(translations.hu)) {
            if (huText === key) {
              header.textContent = translations[lang][enKey];
              break;
            }
          }
        }
      });
    }
    
    if (typeof Papa !== 'undefined') {
      fetchAndDisplayData();
    }
  });
</script>

<!-- Stílus a nyelvválasztó gombokhoz -->
<style>
  .lang-btn {
    padding: 2px 10px;
    border: 1px solid white;
    border-radius: 4px;
    background: transparent;
    color: white;
    cursor: pointer;
    transition: all 0.3s;
  }
  .lang-btn.active {
    background: white;
    color: green;
    font-weight: bold;
  }
  .lang-btn:hover:not(.active) {
    background: rgba(255,255,255,0.2);
  }
</style>
