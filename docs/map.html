<!DOCTYPE html>
<html lang="hu">
<head>
  <!-- Fejléc rész változatlan -->
</head>
<body class="bg-gradient-to-br from-green-50 to-blue-50 font-sans min-h-screen flex flex-col">
  <!-- Tartalom változatlan -->

  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        // ... előző kód változatlan ...

        // JAVÍTOTT ADATFELDOLGOZÁS
        const geojson = {
          type: 'FeatureCollection',
          features: data.map(item => {
            const coords = parseEWKB(item.location);
            if (!coords) return null;
            
            return {
              type: 'Feature',
              geometry: {
                type: 'Point',
                coordinates: [coords.lng, coords.lat]
              },
              properties: {
                id: item.id,
                timestamp: item.timestamp,
                pm1_0: item.pm1_0,
                pm2_5: item.pm2_5,
                pm4_0: item.pm4_0,
                pm10_0: item.pm10_0,
                humidity: item.humidity,
                temperature: item.temperature,
                voc: item.voc,
                nox: item.nox,
                co2: item.co2
              }
            };
          }).filter(feature => feature !== null)
        };

        // ... térkép betöltés utáni kód változatlan ...
      } catch (error) {
        // ... hibakezelés változatlan ...
      }
    });
  </script>
</body>
</html>